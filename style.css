/* ===== CYBERPUNK THEME - 扩张前线 ===== */

:root {
    --bg-color: #050b14;
    --panel-bg: rgba(16, 33, 49, 0.85);
    --primary-color: #00f3ff; /* 霓虹青 - 默认 */
    --secondary-color: #ffae00; /* 警示黄 */
    --success-color: #00ff88;
    --warning-color: #ffae00;
    --danger-color: #ff3366;
    --text-color: #e0f7ff;
    --text-dim: #5c7c8a;
    --border-glow: 0 0 8px rgba(0, 243, 255, 0.4);
    --font-header: 'Orbitron', sans-serif;
    --font-body: 'Rajdhani', sans-serif;
}

/* ===== 多彩主题系统 ===== */
/* 区域 - 青色 Cyan */
body[data-theme="region"] {
    --primary-color: #00f3ff;
    --border-glow: 0 0 8px rgba(0, 243, 255, 0.4);
}

/* 建造 - 橙色 Orange */
body[data-theme="build"] {
    --primary-color: #ff9500;
    --border-glow: 0 0 8px rgba(255, 149, 0, 0.4);
}

/* 科技 - 紫色 Purple */
body[data-theme="tech"] {
    --primary-color: #b967ff;
    --border-glow: 0 0 8px rgba(185, 103, 255, 0.4);
}

/* 仓库 - 绿色 Green */
body[data-theme="storage"] {
    --primary-color: #00ff88;
    --border-glow: 0 0 8px rgba(0, 255, 136, 0.4);
}

/* 地图 - 黄色 Yellow */
body[data-theme="map"] {
    --primary-color: #ffdd00;
    --border-glow: 0 0 8px rgba(255, 221, 0, 0.4);
}

* {
    box-sizing: border-box;
    margin: 0;
    padding: 0;
}

body {
    background-color: var(--bg-color);
    background-image:
        radial-gradient(circle at 50% 50%, #0d1f33 0%, #050b14 100%),
        linear-gradient(rgba(18, 16, 16, 0) 50%, rgba(0, 0, 0, 0.25) 50%),
        linear-gradient(90deg, rgba(255, 0, 0, 0.06), rgba(0, 255, 0, 0.02), rgba(0, 0, 255, 0.06));
    background-size: 100% 100%, 100% 2px, 3px 100%; /* 模拟旧显示器扫描线 */
    color: var(--text-color);
    font-family: var(--font-body);
    min-height: 100vh;
    overflow-x: hidden;
    overflow-y: auto;
    transition: --primary-color 0.5s ease, --border-glow 0.5s ease;
}

/* 为所有使用主题色的元素添加平滑过渡 */
.screen-header,
.info-panel,
.build-category,
.building-card,
.build-card,
.tab-button,
.modal-content,
.toast,
h1, h2, h3,
.building-name,
.build-card-title {
    transition: border-color 0.5s ease, box-shadow 0.5s ease, color 0.3s ease, background-color 0.5s ease;
}

/* ===== APP 布局 ===== */
#app {
    display: flex;
    flex-direction: column;
    min-height: 100vh;
    max-width: 600px;
    margin: 0 auto;
    position: relative;
    background-color: var(--bg-color);
    border-left: 1px solid rgba(0, 243, 255, 0.1);
    border-right: 1px solid rgba(0, 243, 255, 0.1);
}

/* ===== 界面容器 ===== */
.screen {
    flex: 1;
    display: flex;
    flex-direction: column;
    overflow-y: auto;
    width: 100%;
    padding-bottom: 80px;
}

.screen-header {
    flex-shrink: 0;
    width: 100%;
    padding: 15px 20px;
    background: linear-gradient(180deg, rgba(0, 243, 255, 0.1) 0%, transparent 100%);
    border-bottom: 1px solid var(--primary-color);
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 15px;
}

.screen-header h1 {
    font-family: var(--font-header);
    font-size: 1.2rem;
    letter-spacing: 2px;
    text-transform: uppercase;
    color: var(--primary-color);
    text-shadow: 0 0 10px var(--primary-color);
    margin: 0;
}

.region-nav-btn {
    background: rgba(0, 243, 255, 0.1);
    border: 2px solid var(--primary-color);
    color: var(--primary-color);
    font-size: 1.5rem;
    width: 40px;
    height: 40px;
    border-radius: 4px;
    cursor: pointer;
    transition: all 0.3s ease;
    display: flex;
    align-items: center;
    justify-content: center;
    padding: 0;
}

.region-nav-btn:hover {
    background: rgba(0, 243, 255, 0.2);
    box-shadow: 0 0 10px rgba(0, 243, 255, 0.5);
}

.screen-content {
    padding: 15px;
}

/* ===== 面板卡片设计 ===== */
.info-panel, .build-category {
    background: var(--panel-bg);
    border: 1px solid rgba(0, 243, 255, 0.3);
    margin-bottom: 20px;
    padding: 15px;
    position: relative;
    clip-path: polygon(
        0 0,
        100% 0,
        100% calc(100% - 15px),
        calc(100% - 15px) 100%,
        0 100%
    );
    backdrop-filter: blur(5px);
}

.info-panel::before {
    content: '';
    position: absolute;
    bottom: 0;
    right: 0;
    width: 15px;
    height: 15px;
    border-bottom: 2px solid var(--primary-color);
    transform: rotate(-45deg);
    transform-origin: bottom right;
}

.info-panel h2, .build-category h2 {
    color: var(--primary-color);
    font-family: var(--font-header);
    font-size: 0.9rem;
    border-bottom: 1px solid rgba(0, 243, 255, 0.2);
    padding-bottom: 8px;
    margin-bottom: 12px;
    display: flex;
    align-items: center;
}

.info-panel h2::before {
    content: '►';
    margin-right: 8px;
    font-size: 0.7rem;
    color: var(--secondary-color);
}

/* ===== 网格布局 ===== */
.info-grid, .resource-grid {
    display: grid;
    gap: 10px;
}

.info-grid div, .resource-item {
    background: rgba(0, 0, 0, 0.3);
    padding: 8px 12px;
    border-left: 3px solid var(--text-dim);
    font-size: 1.1rem;
    display: flex;
    justify-content: space-between;
}

.resource-item {
    border-left-color: var(--secondary-color);
}

.resource-name {
    color: var(--text-dim);
    font-size: 0.9rem;
    text-transform: uppercase;
}

.resource-value {
    font-family: 'Orbitron', monospace;
    color: #fff;
    font-weight: bold;
}

/* ===== 紧凑布局 ===== */
.info-panel.compact {
    padding: 10px 15px;
    margin-bottom: 12px;
}

.info-panel.compact h2 {
    font-size: 0.8rem;
    margin-bottom: 8px;
    padding-bottom: 5px;
}

.info-grid-compact {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(120px, 1fr));
    gap: 8px;
    font-size: 0.85rem;
    color: var(--text-dim);
}

.info-grid-compact div {
    background: rgba(0, 0, 0, 0.2);
    padding: 5px 8px;
    border-left: 2px solid var(--text-dim);
}

.info-grid-compact span {
    color: var(--text-color);
    font-weight: 500;
}

.region-info-compact {
    display: flex;
    flex-wrap: wrap;
    gap: 15px;
    align-items: center;
    padding: 10px 15px;
    background: rgba(0, 0, 0, 0.3);
    border-left: 3px solid var(--primary-color);
    font-size: 0.9rem;
}

.region-info-item {
    display: flex;
    align-items: center;
    gap: 5px;
}

.btn-resource-info-compact,
.btn-toggle-stats-compact {
    background: rgba(0, 243, 255, 0.1);
    border: 1px solid rgba(0, 243, 255, 0.3);
    color: var(--text-color);
    padding: 4px 10px;
    font-size: 0.85rem;
    cursor: pointer;
    transition: all 0.2s ease;
    border-radius: 3px;
}

.btn-resource-info-compact:hover,
.btn-toggle-stats-compact:hover {
    background: rgba(0, 243, 255, 0.2);
    border-color: var(--primary-color);
}

.build-info-compact {
    display: flex;
    gap: 10px;
    margin-bottom: 15px;
}

.build-info-box {
    background: rgba(0, 0, 0, 0.3);
    border-left: 3px solid var(--primary-color);
    padding: 8px 15px;
    font-size: 0.9rem;
    color: var(--text-color);
}

.build-info-box span {
    color: var(--primary-color);
    font-weight: 600;
}

.resource-grid-compact {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(80px, 1fr));
    gap: 8px;
    max-height: 200px;
    overflow-y: auto;
    padding-right: 5px;
}

.resource-item-compact {
    background: rgba(0, 0, 0, 0.2);
    padding: 5px 8px;
    border-left: 2px solid var(--secondary-color);
    display: flex;
    flex-direction: column;
    align-items: flex-start;
    gap: 2px;
}

.resource-item-compact .resource-name {
    color: var(--text-dim);
    font-size: 0.7rem;
    text-transform: uppercase;
    letter-spacing: 0.5px;
}

.resource-item-compact .resource-value {
    font-family: 'Orbitron', monospace;
    color: var(--text-color);
    font-weight: bold;
    font-size: 1rem;
}

/* 电力状态显示 */
.power-status-item {
    font-family: 'Orbitron', monospace;
    font-weight: bold;
    font-size: 0.9rem;
    padding: 5px 8px;
    border-left: 3px solid;
    transition: all 0.3s ease;
}

.power-status-item.power-good {
    color: var(--success-color);
    border-left-color: var(--success-color);
    background: rgba(0, 255, 136, 0.1);
}

.power-status-item.power-warning {
    color: var(--warning-color);
    border-left-color: var(--warning-color);
    background: rgba(255, 174, 0, 0.15);
    animation: powerPulse 2s ease-in-out infinite;
}

.power-status-item.power-critical {
    color: var(--danger-color);
    border-left-color: var(--danger-color);
    background: rgba(255, 51, 102, 0.2);
    animation: powerPulse 1s ease-in-out infinite;
}

@keyframes powerPulse {
    0%, 100% { opacity: 1; }
    50% { opacity: 0.6; }
}

/* ===== 建筑列表 (区域界面) - 网格卡片 ===== */
.buildings-list {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(120px, 1fr));
    gap: 10px;
}

.building-card-compact {
    background: var(--panel-bg);
    border: 1px solid rgba(0, 243, 255, 0.3);
    padding: 10px;
    cursor: pointer;
    transition: all 0.3s ease;
    position: relative;
}

.building-card-compact:hover {
    border-color: var(--primary-color);
    box-shadow: var(--border-glow);
    transform: scale(1.05);
}

.building-card-compact-header {
    display: flex;
    flex-direction: column;
    gap: 5px;
    margin-bottom: 5px;
}

.building-card-compact-name {
    color: var(--primary-color);
    font-family: var(--font-header);
    font-size: 0.85rem;
    font-weight: bold;
}

.building-card-compact-id {
    color: var(--text-dim);
    font-size: 0.7rem;
    font-family: 'Orbitron', monospace;
}

.building-card-compact-task {
    margin-top: 6px;
    padding: 4px 6px;
    background: rgba(0, 243, 255, 0.1);
    border-left: 2px solid var(--secondary-color);
    color: var(--text-color);
    font-size: 0.75rem;
    line-height: 1.2;
}

.building-status {
    padding: 3px 8px;
    font-size: 0.7rem;
    border-radius: 2px;
    font-family: var(--font-header);
    text-transform: uppercase;
    letter-spacing: 1px;
}

.status-active {
    background-color: var(--success-color);
    color: #000;
    box-shadow: 0 0 8px var(--success-color);
}

.status-inactive {
    background-color: #888;
    color: #fff;
}

.status-warning {
    background-color: var(--warning-color);
    color: #000;
    animation: statusBlink 3s ease-in-out infinite;
}

.status-disabled {
    background-color: var(--danger-color);
    color: #fff;
    animation: statusBlink 2s ease-in-out infinite;
}

@keyframes statusBlink {
    0%, 100% { opacity: 1; }
    50% { opacity: 0.6; }
}

/* Building Progress Bar */
.building-progress-bar-container {
    height: 4px;
    background: #333;
    margin-top: 8px;
    border-radius: 2px;
    overflow: hidden;
}

.building-progress-bar-fill {
    width: 0%;
    height: 100%;
    background: var(--primary-color);
    transition: width 0.1s linear;
    box-shadow: 0 0 4px var(--primary-color);
}

/* Pulse Animation for Production Complete */
.pulse-success {
    animation: pulseGreen 0.5s ease-out;
}

@keyframes pulseGreen {
    0% {
        box-shadow: 0 0 0 0 rgba(0, 255, 136, 0.7);
        border-color: #fff;
    }
    70% {
        box-shadow: 0 0 20px 10px rgba(0, 255, 136, 0);
        border-color: var(--success-color);
    }
    100% {
        box-shadow: 0 0 0 0 rgba(0, 255, 136, 0);
        border-color: rgba(0, 243, 255, 0.3);
    }
}

/* ===== 建筑管理模态框 ===== */
.building-manage-modal {
    min-width: 400px;
    max-width: 500px;
}

.building-manage-modal .modal-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
}

.building-manage-modal .modal-header h3 {
    flex: 1;
}

.building-manage-modal .modal-header .building-status {
    margin-left: 10px;
}

.building-section {
    margin-top: 15px;
    padding-top: 15px;
    border-top: 1px solid rgba(0, 243, 255, 0.1);
}

.building-section h4 {
    color: var(--secondary-color);
    font-family: var(--font-header);
    font-size: 0.85rem;
    margin-bottom: 8px;
    text-transform: uppercase;
}

.building-property-warning {
    color: var(--warning-color);
    font-size: 0.85rem;
    font-style: italic;
}

.building-property .highlight {
    color: var(--primary-color);
    font-weight: bold;
    text-shadow: 0 0 4px rgba(0, 243, 255, 0.5);
}

/* ===== 配方选择模态框 ===== */
.recipe-selection-modal {
    min-width: 500px;
    max-width: 700px;
}

.recipes-grid {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
    gap: 12px;
    max-height: 60vh;
    overflow-y: auto;
}

.recipe-card {
    background: var(--panel-bg);
    border: 2px solid rgba(0, 243, 255, 0.3);
    border-radius: 8px;
    padding: 12px;
    cursor: pointer;
    transition: all 0.3s ease;
}

.recipe-card:hover {
    border-color: var(--primary-color);
    box-shadow: 0 0 12px rgba(0, 243, 255, 0.4);
    transform: translateY(-2px);
}

.recipe-card.selected {
    border-color: var(--success-color);
    background: rgba(0, 255, 136, 0.1);
}

.recipe-card-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 10px;
    padding-bottom: 8px;
    border-bottom: 1px solid rgba(0, 243, 255, 0.2);
}

.recipe-card-header h4 {
    font-family: var(--font-header);
    font-size: 0.95rem;
    color: var(--secondary-color);
    margin: 0;
}

.recipe-selected-badge {
    background: var(--success-color);
    color: var(--bg-color);
    padding: 2px 8px;
    border-radius: 4px;
    font-size: 0.7rem;
    font-weight: bold;
}

.recipe-card-body {
    font-size: 0.85rem;
}

.recipe-label {
    color: var(--secondary-color);
    font-weight: bold;
    margin-right: 4px;
}

.recipe-ingredients,
.recipe-results,
.recipe-time {
    margin: 6px 0;
}

.recipe-arrow {
    text-align: center;
    color: var(--primary-color);
    font-size: 1.2rem;
    margin: 8px 0;
}

/* ===== 新配方选择网格 ===== */
.recipe-grid {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(140px, 1fr));
    gap: 12px;
    max-height: 60vh;
    overflow-y: auto;
    margin-top: 15px;
}

.recipe-grid-card {
    background: var(--panel-bg);
    border: 2px solid rgba(0, 243, 255, 0.3);
    padding: 15px;
    cursor: pointer;
    transition: all 0.3s ease;
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    gap: 8px;
    min-height: 80px;
    position: relative;
}

.recipe-grid-card:hover {
    border-color: var(--primary-color);
    box-shadow: 0 0 15px rgba(0, 243, 255, 0.4);
    transform: translateY(-2px);
}

.recipe-grid-card.current-recipe {
    border-color: var(--success-color);
    background: rgba(0, 255, 136, 0.1);
}

.recipe-grid-name {
    font-family: var(--font-header);
    font-size: 0.9rem;
    color: var(--primary-color);
    font-weight: bold;
    text-align: center;
    line-height: 1.3;
}

.recipe-grid-badge {
    background: var(--success-color);
    color: var(--bg-color);
    padding: 2px 8px;
    border-radius: 3px;
    font-size: 0.7rem;
    font-weight: bold;
    position: absolute;
    top: 5px;
    right: 5px;
}

/* ===== 配方详情模态框 ===== */
.recipe-detail-modal {
    min-width: 400px;
    max-width: 500px;
}

.recipe-detail-section {
    margin: 15px 0;
}

.recipe-detail-label {
    color: var(--secondary-color);
    font-family: var(--font-header);
    font-weight: bold;
    font-size: 0.9rem;
    margin-bottom: 8px;
}

.recipe-detail-list {
    display: flex;
    flex-direction: column;
    gap: 6px;
    margin-top: 8px;
}

.detail-item {
    background: rgba(0, 0, 0, 0.3);
    padding: 8px 12px;
    border-left: 3px solid var(--primary-color);
    font-size: 0.9rem;
    color: var(--text-color);
}

.recipe-detail-arrow {
    text-align: center;
    color: var(--primary-color);
    font-size: 1.5rem;
    margin: 12px 0;
    font-weight: bold;
}

.recipe-detail-time {
    margin-top: 15px;
    padding-top: 15px;
    border-top: 1px solid rgba(0, 243, 255, 0.2);
    font-size: 0.9rem;
}

.recipe-detail-time .recipe-detail-label {
    display: inline;
    margin-right: 8px;
}

/* ===== 建造界面卡片 ===== */
.building-cards {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(120px, 1fr));
    gap: 8px;
}

.build-card {
    background: var(--panel-bg);
    border: 1px solid rgba(0, 243, 255, 0.3);
    padding: 8px;
    transition: all 0.3s ease;
    position: relative;
    cursor: pointer;
}

.build-card:hover {
    border-color: var(--primary-color);
    box-shadow: var(--border-glow);
    transform: scale(1.05);
}

.build-card-title {
    color: var(--primary-color);
    font-family: var(--font-header);
    font-size: 0.9rem;
    font-weight: bold;
    margin-bottom: 6px;
}

.build-card-cost-compact {
    display: flex;
    flex-direction: column;
    gap: 3px;
}

.build-card-cost-compact .cost-item {
    font-size: 0.7rem;
    padding: 2px 4px;
    border-left: 2px solid;
    background: rgba(0, 0, 0, 0.2);
}

.cost-item.sufficient {
    color: var(--success-color);
    border-left-color: var(--success-color);
}

.cost-item.insufficient {
    color: var(--danger-color);
    border-left-color: var(--danger-color);
}

/* ===== 建筑详情模态框 ===== */
.building-detail-modal {
    min-width: 350px;
}

.modal-header {
    padding: 20px 24px 10px;
    border-bottom: 1px solid rgba(0, 243, 255, 0.2);
}

.modal-header h3 {
    color: var(--primary-color);
    font-family: var(--font-header);
    font-size: 1.2rem;
    text-transform: uppercase;
    letter-spacing: 1px;
}

.building-description {
    color: var(--text-dim);
    font-size: 0.9rem;
    margin-bottom: 15px;
    line-height: 1.5;
}

.building-properties {
    display: grid;
    grid-template-columns: repeat(2, 1fr);
    gap: 8px;
    margin-bottom: 15px;
}

.building-property {
    background: rgba(0, 0, 0, 0.3);
    padding: 6px 10px;
    border-left: 2px solid var(--text-dim);
    font-size: 0.85rem;
    color: var(--text-color);
}

.building-costs h4 {
    color: var(--secondary-color);
    font-family: var(--font-header);
    font-size: 0.85rem;
    margin-bottom: 8px;
    text-transform: uppercase;
}

.cost-item-detail {
    background: rgba(0, 0, 0, 0.3);
    padding: 6px 10px;
    margin-bottom: 5px;
    border-left: 3px solid;
    font-size: 0.9rem;
}

.cost-item-detail.sufficient {
    color: var(--success-color);
    border-left-color: var(--success-color);
}

.cost-item-detail.insufficient {
    color: var(--danger-color);
    border-left-color: var(--danger-color);
}

/* ===== 按钮样式 ===== */
.btn {
    padding: 6px 12px;
    border: 1px solid;
    cursor: pointer;
    font-family: var(--font-header);
    font-size: 0.75rem;
    text-transform: uppercase;
    letter-spacing: 1px;
    transition: all 0.2s;
    background: transparent;
}

.btn-danger {
    border-color: var(--danger-color);
    color: var(--danger-color);
}

.btn-danger:hover {
    background-color: var(--danger-color);
    color: #000;
    box-shadow: 0 0 10px var(--danger-color);
}

.btn-warning {
    border-color: var(--warning-color);
    color: var(--warning-color);
}

.btn-warning:hover {
    background-color: var(--warning-color);
    color: #000;
    box-shadow: 0 0 10px var(--warning-color);
}

.btn-confirm {
    border-color: var(--primary-color);
    background-color: var(--primary-color);
    color: #000;
    font-weight: bold;
}

.btn-confirm:hover {
    box-shadow: 0 0 15px var(--primary-color);
}

.btn-cancel {
    border-color: var(--text-dim);
    color: var(--text-dim);
}

.btn-cancel:hover {
    background-color: var(--text-dim);
    color: #000;
}

.btn-build {
    width: 100%;
    padding: 8px;
    background: linear-gradient(135deg, var(--success-color), #00cc6f);
    color: #000;
    border: none;
    cursor: pointer;
    font-family: var(--font-header);
    font-size: 0.85rem;
    font-weight: bold;
    text-transform: uppercase;
    margin-top: 10px;
    transition: all 0.3s;
}

.btn-build:hover:not(:disabled) {
    box-shadow: 0 0 15px var(--success-color);
    transform: translateY(-2px);
}

.btn-build:disabled {
    background: rgba(92, 124, 138, 0.3);
    color: var(--text-dim);
    cursor: not-allowed;
}

/* ===== 底部 Tab 栏 ===== */
#tab-bar {
    position: fixed;
    bottom: 0;
    left: 50%;
    transform: translateX(-50%);
    width: 100%;
    max-width: 600px;
    height: 60px;
    background: rgba(5, 11, 20, 0.95);
    border-top: 1px solid var(--primary-color);
    display: flex;
    justify-content: space-around;
    align-items: center;
    z-index: 100;
}

.tab-button {
    background: transparent;
    border: none;
    color: var(--text-dim);
    font-family: var(--font-header);
    font-size: 0.8rem;
    padding: 10px;
    cursor: pointer;
    transition: all 0.3s ease;
    text-transform: uppercase;
    position: relative;
    flex: 1;
    height: 100%;
    border-top: 3px solid transparent;
}

/* 为每个tab设置独特的颜色指示 */
.tab-button:nth-child(1) { border-top-color: #00f3ff; } /* 区域 - 青色 */
.tab-button:nth-child(2) { border-top-color: #ff9500; } /* 建造 - 橙色 */
.tab-button:nth-child(3) { border-top-color: #b967ff; } /* 科技 - 紫色 */
.tab-button:nth-child(4) { border-top-color: #00ff88; } /* 仓库 - 绿色 */
.tab-button:nth-child(5) { border-top-color: #ffdd00; } /* 地图 - 黄色 */

.tab-button:hover {
    color: var(--primary-color);
    background: rgba(0, 243, 255, 0.05);
}

.tab-button:nth-child(1):hover { color: #00f3ff; background: rgba(0, 243, 255, 0.1); }
.tab-button:nth-child(2):hover { color: #ff9500; background: rgba(255, 149, 0, 0.1); }
.tab-button:nth-child(3):hover { color: #b967ff; background: rgba(185, 103, 255, 0.1); }
.tab-button:nth-child(4):hover { color: #00ff88; background: rgba(0, 255, 136, 0.1); }
.tab-button:nth-child(5):hover { color: #ffdd00; background: rgba(255, 221, 0, 0.1); }

.tab-button.active {
    color: var(--bg-color);
    background: var(--primary-color);
    box-shadow: 0 0 15px var(--primary-color);
    font-weight: bold;
}

/* ===== 快捷操作按钮 ===== */
#quick-actions {
    position: fixed;
    right: 20px;
    bottom: 80px;
    display: flex;
    flex-direction: column;
    gap: 10px;
    z-index: 1000;
}

.quick-btn {
    width: 50px;
    height: 50px;
    border-radius: 50%;
    background: rgba(0, 243, 255, 0.2);
    border: 2px solid var(--primary-color);
    color: var(--primary-color);
    font-size: 1.5rem;
    cursor: pointer;
    transition: all 0.3s ease;
    box-shadow: 0 0 10px rgba(0, 243, 255, 0.3);
}

.quick-btn:hover {
    background: var(--primary-color);
    color: var(--bg-color);
    transform: scale(1.1);
    box-shadow: 0 0 20px rgba(0, 243, 255, 0.6);
}

.quick-btn:active {
    transform: scale(0.95);
}

/* ===== 空消息 ===== */
.empty-message {
    color: var(--text-dim);
    font-style: italic;
    text-align: center;
    padding: 20px;
    border: 1px dashed var(--text-dim);
}

/* ===== 模态对话框 ===== */
.modal-overlay {
    position: fixed;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    background-color: rgba(0, 0, 0, 0.85);
    display: flex;
    justify-content: center;
    align-items: center;
    z-index: 10000;
    animation: fadeInOverlay 0.2s ease-out;
}

.modal-overlay.fade-out {
    animation: fadeOutOverlay 0.2s ease-out forwards;
}

.modal-dialog {
    animation: slideInModal 0.3s ease-out;
}

.modal-content {
    background: var(--panel-bg);
    border: 2px solid var(--primary-color);
    box-shadow: 0 0 30px var(--primary-color);
    min-width: 300px;
    max-width: 500px;
    padding: 0;
    backdrop-filter: blur(10px);
    clip-path: polygon(
        0 0,
        100% 0,
        100% calc(100% - 15px),
        calc(100% - 15px) 100%,
        0 100%
    );
}

.modal-body {
    padding: 24px;
    color: var(--text-color);
    font-size: 1rem;
    line-height: 1.6;
}

.modal-actions {
    padding: 16px 24px;
    display: flex;
    justify-content: flex-end;
    gap: 12px;
    border-top: 1px solid rgba(0, 243, 255, 0.2);
}

@keyframes fadeInOverlay {
    from { opacity: 0; }
    to { opacity: 1; }
}

@keyframes fadeOutOverlay {
    from { opacity: 1; }
    to { opacity: 0; }
}

@keyframes slideInModal {
    from {
        transform: translateY(-50px);
        opacity: 0;
    }
    to {
        transform: translateY(0);
        opacity: 1;
    }
}

/* ===== Toast通知 ===== */
#toast-container {
    position: fixed;
    top: 20px;
    right: 20px;
    z-index: 9999;
    display: flex;
    flex-direction: column;
    gap: 10px;
}

.toast {
    background: var(--panel-bg);
    border: 1px solid var(--primary-color);
    border-left: 4px solid var(--primary-color);
    padding: 12px 16px;
    min-width: 250px;
    max-width: 400px;
    box-shadow: 0 0 20px rgba(0, 243, 255, 0.5);
    animation: slideIn 0.3s ease-out;
    display: flex;
    align-items: center;
    gap: 10px;
    backdrop-filter: blur(10px);
}

.toast.success {
    border-left-color: var(--success-color);
    box-shadow: 0 0 20px rgba(0, 255, 136, 0.3);
}

.toast.error {
    border-left-color: var(--danger-color);
    box-shadow: 0 0 20px rgba(255, 51, 102, 0.3);
}

.toast.warning {
    border-left-color: var(--warning-color);
    box-shadow: 0 0 20px rgba(255, 174, 0, 0.3);
}

.toast-icon {
    font-size: 20px;
    flex-shrink: 0;
}

.toast-message {
    flex: 1;
    color: var(--text-color);
    font-size: 0.9rem;
}

.toast.fade-out {
    animation: fadeOut 0.3s ease-out forwards;
}

@keyframes slideIn {
    from {
        transform: translateX(400px);
        opacity: 0;
    }
    to {
        transform: translateX(0);
        opacity: 1;
    }
}

@keyframes fadeOut {
    from {
        transform: translateX(0);
        opacity: 1;
    }
    to {
        transform: translateX(400px);
        opacity: 0;
    }
}

/* ===== 教程系统 ===== */
.tutorial-overlay {
    z-index: 10000;
    backdrop-filter: blur(5px);
}

.tutorial-dialog {
    max-width: 600px;
    margin: 80px auto;
}

.tutorial-progress {
    background: rgba(0, 243, 255, 0.2);
    padding: 4px 12px;
    border-radius: 12px;
    font-size: 0.85em;
    color: var(--secondary-color);
}

.tutorial-body p {
    margin: 10px 0;
    line-height: 1.6;
    white-space: pre-line;
}

.tutorial-body p:first-child {
    margin-top: 0;
}

.tutorial-body p:last-child {
    margin-bottom: 0;
}

.tutorial-highlight {
    animation: tutorialPulse 2s ease-in-out infinite;
    box-shadow: 0 0 20px rgba(255, 174, 0, 0.8) !important;
}

@keyframes tutorialPulse {
    0%, 100% {
        box-shadow: 0 0 20px rgba(255, 174, 0, 0.5);
    }
    50% {
        box-shadow: 0 0 30px rgba(255, 174, 0, 1);
    }
}

.btn-primary {
    background: linear-gradient(135deg, var(--primary-color), var(--secondary-color));
    color: var(--bg-color);
    font-weight: bold;
}

.btn-primary:hover {
    box-shadow: 0 0 20px rgba(0, 243, 255, 0.5);
}

.btn-secondary {
    background: rgba(255, 255, 255, 0.1);
    border-color: rgba(255, 255, 255, 0.3);
}

/* ===== 滚动条美化 ===== */
::-webkit-scrollbar {
    width: 6px;
}

::-webkit-scrollbar-track {
    background: #000;
}

::-webkit-scrollbar-thumb {
    background: var(--primary-color);
    border-radius: 3px;
    box-shadow: 0 0 5px var(--primary-color);
}

/* ===== 时间系统 ===== */
#time-remaining {
    color: var(--secondary-color);
    font-family: 'Orbitron', monospace;
}

/* ===== 响应式 ===== */
@media (max-width: 768px) {
    .building-cards {
        grid-template-columns: repeat(2, 1fr);
    }

    .buildings-list {
        grid-template-columns: repeat(2, 1fr);
    }

    .info-grid,
    .resource-grid {
        grid-template-columns: 1fr;
    }

    .info-grid-compact {
        grid-template-columns: repeat(2, 1fr);
    }

    .resource-grid-compact {
        grid-template-columns: repeat(3, 1fr);
    }

    .building-properties {
        grid-template-columns: 1fr;
    }

    .building-detail-modal,
    .building-manage-modal {
        min-width: 300px;
    }

    .tab-button {
        font-size: 0.7rem;
    }

    #toast-container {
        right: 10px;
        left: 10px;
        top: 10px;
    }

    .toast {
        min-width: auto;
        max-width: none;
    }
}

/* ===== 科技树界面 ===== */
#tech-tree-container {
    display: flex;
    flex-direction: column;
    gap: 20px;
}

/* 科技网格 - 小卡片 */
.tech-grid {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(110px, 1fr));
    gap: 8px;
}

.tech-card-compact {
    background: var(--panel-bg);
    border: 2px solid;
    padding: 10px;
    cursor: pointer;
    transition: all 0.3s ease;
    display: flex;
    flex-direction: column;
    align-items: center;
    gap: 6px;
    min-height: 70px;
    justify-content: center;
}

.tech-card-compact:hover {
    transform: translateY(-2px);
    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.4);
}

/* 可研究 - 黄色 */
.tech-card-compact.available,
.tech-card-compact.researching {
    border-color: var(--warning-color);
    background: rgba(255, 174, 0, 0.1);
}

.tech-card-compact.available:hover,
.tech-card-compact.researching:hover {
    box-shadow: 0 4px 12px rgba(255, 174, 0, 0.4);
}

/* 已锁定 - 红色 */
.tech-card-compact.locked {
    border-color: var(--danger-color);
    background: rgba(255, 51, 102, 0.1);
    opacity: 0.7;
}

.tech-card-compact.locked:hover {
    box-shadow: 0 4px 12px rgba(255, 51, 102, 0.4);
}

/* 已完成 - 绿色 */
.tech-card-compact.researched {
    border-color: var(--success-color);
    background: rgba(0, 255, 136, 0.1);
}

.tech-card-compact.researched:hover {
    box-shadow: 0 4px 12px rgba(0, 255, 136, 0.4);
}

.tech-card-compact-name {
    font-family: var(--font-header);
    font-size: 0.85rem;
    font-weight: bold;
    text-align: center;
    color: var(--text-color);
}

.tech-card-compact-status {
    font-size: 0.7rem;
    padding: 2px 8px;
    border-radius: 2px;
    font-family: var(--font-header);
    text-transform: uppercase;
    letter-spacing: 1px;
}

.tech-card-compact.available .tech-card-compact-status {
    background: var(--warning-color);
    color: #000;
}

.tech-card-compact.locked .tech-card-compact-status {
    background: var(--danger-color);
    color: #fff;
}

.tech-card-compact.researched .tech-card-compact-status {
    background: var(--success-color);
    color: #000;
}

.tech-card-compact.researching .tech-card-compact-status {
    background: var(--warning-color);
    color: #000;
    animation: badgePulse 1.5s ease-in-out infinite;
}

/* 科技详情模态框 */
.tech-detail-modal {
    min-width: 450px;
    max-width: 600px;
}

.tech-detail-modal .tech-description {
    font-size: 0.95rem;
    line-height: 1.6;
    margin-bottom: 15px;
    color: var(--text-dim);
}

.tech-detail-modal .tech-prerequisites,
.tech-detail-modal .tech-cost,
.tech-detail-modal .tech-time,
.tech-detail-modal .tech-unlocks {
    margin: 10px 0;
    padding: 10px;
    background: rgba(0, 0, 0, 0.3);
    border-left: 3px solid;
}

.tech-detail-modal .tech-prerequisites {
    border-left-color: var(--warning-color);
}

.tech-detail-modal .tech-cost {
    border-left-color: var(--secondary-color);
}

.tech-detail-modal .tech-time {
    border-left-color: var(--primary-color);
}

.tech-detail-modal .tech-unlocks {
    border-left-color: var(--success-color);
}

.tech-detail-modal .tech-status-badge {
    padding: 4px 10px;
    font-size: 0.7rem;
    border-radius: 3px;
    font-family: var(--font-header);
    text-transform: uppercase;
    letter-spacing: 1px;
    font-weight: bold;
    margin-left: 10px;
}

.tech-detail-modal .tech-status-badge.available {
    background: var(--warning-color);
    color: #000;
}

.tech-detail-modal .tech-status-badge.locked {
    background: var(--danger-color);
    color: #fff;
}

.tech-detail-modal .tech-status-badge.researched {
    background: var(--success-color);
    color: #000;
}

.tech-detail-modal .tech-status-badge.researching {
    background: var(--warning-color);
    color: #000;
    animation: badgePulse 1.5s ease-in-out infinite;
}

/* 科研包信息面板 */
.science-info-panel {
    background: rgba(0, 243, 255, 0.1);
    border: 2px solid var(--primary-color);
    padding: 15px;
    margin-bottom: 15px;
    box-shadow: 0 0 15px rgba(0, 243, 255, 0.2);
}

.science-info-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 12px;
    padding-bottom: 10px;
    border-bottom: 1px solid rgba(0, 243, 255, 0.3);
}

.science-info-title {
    color: var(--primary-color);
    font-family: var(--font-header);
    font-size: 0.95rem;
    font-weight: bold;
    text-transform: uppercase;
    letter-spacing: 1.5px;
}

.science-packs-grid {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(120px, 1fr));
    gap: 10px;
}

.science-pack-item {
    background: rgba(0, 0, 0, 0.3);
    border: 1px solid rgba(0, 243, 255, 0.3);
    padding: 8px;
    display: flex;
    flex-direction: column;
    align-items: center;
    gap: 6px;
    transition: all 0.3s ease;
}

.science-pack-item:hover {
    border-color: var(--primary-color);
    box-shadow: 0 0 10px rgba(0, 243, 255, 0.3);
}

.science-pack-name {
    font-size: 0.8rem;
    color: var(--text-color);
    text-align: center;
    font-family: var(--font-header);
}

.science-pack-count {
    font-size: 1.1rem;
    color: var(--primary-color);
    font-family: 'Orbitron', monospace;
    font-weight: bold;
}

/* 当前研究状态面板 */
.current-research {
    background: linear-gradient(135deg, rgba(185, 103, 255, 0.15) 0%, rgba(185, 103, 255, 0.05) 100%);
    border: 2px solid var(--primary-color);
    padding: 20px;
    margin-bottom: 10px;
    box-shadow: 0 0 20px rgba(185, 103, 255, 0.3);
    clip-path: polygon(
        0 0,
        100% 0,
        100% calc(100% - 15px),
        calc(100% - 15px) 100%,
        0 100%
    );
}

.current-research h3 {
    color: var(--primary-color);
    font-family: var(--font-header);
    font-size: 1rem;
    text-transform: uppercase;
    letter-spacing: 2px;
    margin-bottom: 12px;
    text-shadow: 0 0 10px var(--primary-color);
}

.research-info {
    display: flex;
    flex-direction: column;
    gap: 10px;
}

.research-name {
    color: var(--text-color);
    font-family: var(--font-header);
    font-size: 1.1rem;
    font-weight: bold;
}

.research-progress-bar {
    position: relative;
    width: 100%;
    height: 30px;
    background: rgba(0, 0, 0, 0.5);
    border: 2px solid var(--primary-color);
    overflow: hidden;
    box-shadow: inset 0 0 10px rgba(0, 0, 0, 0.5);
}

.research-progress-fill {
    height: 100%;
    background: linear-gradient(90deg,
        var(--primary-color) 0%,
        rgba(185, 103, 255, 0.6) 50%,
        var(--primary-color) 100%);
    background-size: 200% 100%;
    animation: progressShine 2s linear infinite;
    box-shadow: 0 0 15px var(--primary-color);
    transition: width 0.3s ease;
}

@keyframes progressShine {
    0% { background-position: 200% 0; }
    100% { background-position: -200% 0; }
}

.research-progress-text {
    position: absolute;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    color: #fff;
    font-family: 'Orbitron', monospace;
    font-weight: bold;
    font-size: 0.9rem;
    text-shadow: 0 0 5px rgba(0, 0, 0, 0.8), 0 0 10px var(--primary-color);
    z-index: 1;
}

.research-speed {
    margin-top: 10px;
    padding: 6px 10px;
    background: rgba(0, 243, 255, 0.1);
    border: 1px solid var(--primary-color);
    border-radius: 4px;
    color: var(--primary-color);
    font-family: var(--font-header);
    font-size: 0.85rem;
    text-align: center;
}

.research-warning {
    margin-top: 10px;
    padding: 8px 12px;
    background: rgba(255, 174, 0, 0.15);
    border: 2px solid var(--warning-color);
    border-radius: 4px;
    color: var(--warning-color);
    font-family: var(--font-header);
    font-size: 0.85rem;
    text-align: center;
    animation: warningPulse 2s ease-in-out infinite;
}

@keyframes warningPulse {
    0%, 100% {
        box-shadow: 0 0 10px rgba(255, 174, 0, 0.3);
        border-color: var(--warning-color);
    }
    50% {
        box-shadow: 0 0 20px rgba(255, 174, 0, 0.6);
        border-color: rgba(255, 174, 0, 1);
    }
}

/* 响应式调整 - 科技树 */
@media (max-width: 768px) {
    .tech-grid {
        grid-template-columns: repeat(auto-fill, minmax(120px, 1fr));
    }

    .current-research {
        padding: 15px;
    }

    .tech-detail-modal {
        min-width: 300px;
    }
}

/* ===== 生产统计面板 ===== */
.btn-toggle-stats {
    width: 100%;
    margin-top: 10px;
    padding: 8px;
    background: rgba(0, 243, 255, 0.1);
    border: 1px solid var(--primary-color);
    color: var(--primary-color);
    font-family: var(--font-header);
    font-size: 0.8rem;
    cursor: pointer;
    transition: all 0.3s ease;
    text-transform: uppercase;
    letter-spacing: 1px;
}

.btn-toggle-stats:hover {
    background: rgba(0, 243, 255, 0.2);
    box-shadow: 0 0 10px rgba(0, 243, 255, 0.3);
}

.btn-resource-info {
    padding: 4px 8px;
    background: rgba(255, 174, 0, 0.1);
    border: 1px solid var(--secondary-color);
    color: var(--secondary-color);
    font-family: var(--font-header);
    font-size: 0.75rem;
    cursor: pointer;
    transition: all 0.3s ease;
    letter-spacing: 0.5px;
}

.btn-resource-info:hover {
    background: rgba(255, 174, 0, 0.2);
    box-shadow: 0 0 10px rgba(255, 174, 0, 0.3);
}

.production-stats-section {
    margin-top: 12px;
    padding-top: 12px;
    border-top: 1px solid rgba(0, 243, 255, 0.2);
}

.production-stats {
    min-height: 50px;
}

.stats-message {
    color: var(--text-dim);
    font-style: italic;
    text-align: center;
    padding: 10px;
}

/* 建筑统计 */
.building-summary {
    min-height: 50px;
}

.building-summary-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
    gap: 10px;
    margin-top: 10px;
}

.building-summary-item {
    background: rgba(0, 243, 255, 0.05);
    border: 1px solid rgba(0, 243, 255, 0.2);
    border-radius: 4px;
    padding: 8px;
    text-align: center;
}

.building-summary-category {
    font-size: 0.9em;
    color: var(--secondary-color);
    margin-bottom: 4px;
}

.building-summary-count {
    font-size: 1.1em;
    font-weight: bold;
    color: var(--primary-color);
    margin-bottom: 2px;
}

.building-summary-status {
    font-size: 0.85em;
    color: var(--text-dim);
}

.stats-grid {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(180px, 1fr));
    gap: 8px;
}

.stat-item {
    background: rgba(0, 0, 0, 0.3);
    padding: 8px 10px;
    border-left: 3px solid;
    transition: all 0.3s ease;
}

.stat-item.stat-positive {
    border-left-color: var(--success-color);
    background: rgba(0, 255, 136, 0.05);
}

.stat-item.stat-negative {
    border-left-color: var(--danger-color);
    background: rgba(255, 51, 102, 0.05);
}

.stat-name {
    color: var(--text-color);
    font-size: 0.85rem;
    font-weight: 500;
    margin-bottom: 4px;
}

.stat-values {
    display: flex;
    flex-wrap: wrap;
    gap: 6px;
    font-size: 0.75rem;
    font-family: 'Orbitron', monospace;
}

.stat-production {
    color: var(--success-color);
    font-weight: bold;
}

.stat-consumption {
    color: var(--warning-color);
    font-weight: bold;
}

.stat-net {
    color: var(--primary-color);
    font-weight: bold;
    margin-left: auto;
}

.stat-item.stat-positive .stat-net {
    color: var(--success-color);
    text-shadow: 0 0 5px var(--success-color);
}

.stat-item.stat-negative .stat-net {
    color: var(--danger-color);
    text-shadow: 0 0 5px var(--danger-color);
}

/* 响应式调整 - 生产统计 */
@media (max-width: 768px) {
    .stats-grid {
        grid-template-columns: 1fr;
    }
}

/* ===== 仓库界面 ===== */
.storage-resources-list {
    display: flex;
    flex-direction: column;
    gap: 12px;
}

.storage-category {
    margin-bottom: 8px;
}

.storage-category-header {
    color: var(--primary-color);
    font-family: var(--font-header);
    font-size: 0.85rem;
    text-transform: uppercase;
    letter-spacing: 1.5px;
    margin-bottom: 8px;
    padding-bottom: 4px;
    border-bottom: 2px solid var(--primary-color);
    text-shadow: 0 0 8px var(--primary-color);
}

.storage-resources-grid {
    display: grid;
    grid-template-columns: repeat(4, 1fr);
    gap: 8px;
}

.storage-resource-item {
    background: rgba(0, 0, 0, 0.3);
    border: 2px solid rgba(0, 243, 255, 0.3);
    padding: 8px;
    transition: all 0.3s ease;
}

.storage-resource-item:hover {
    border-color: var(--primary-color);
    box-shadow: 0 0 10px rgba(0, 243, 255, 0.3);
}

.storage-resource-item.near-full {
    border-color: var(--warning-color);
    background: rgba(255, 174, 0, 0.1);
}

.storage-resource-item.full {
    border-color: var(--danger-color);
    background: rgba(255, 51, 102, 0.1);
    animation: storageFullPulse 2s ease-in-out infinite;
}

@keyframes storageFullPulse {
    0%, 100% { box-shadow: 0 0 10px rgba(255, 51, 102, 0.3); }
    50% { box-shadow: 0 0 20px rgba(255, 51, 102, 0.5); }
}

.storage-resource-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 8px;
}

.storage-resource-name {
    font-family: var(--font-header);
    font-size: 0.85rem;
    color: var(--text-color);
    font-weight: 500;
}

.storage-resource-percentage {
    font-family: 'Orbitron', monospace;
    font-size: 0.75rem;
    color: var(--primary-color);
    font-weight: bold;
}

.storage-resource-item.near-full .storage-resource-percentage {
    color: var(--warning-color);
}

.storage-resource-item.full .storage-resource-percentage {
    color: var(--danger-color);
}

.storage-resource-bar {
    height: 8px;
    background: rgba(0, 0, 0, 0.5);
    border: 1px solid rgba(0, 243, 255, 0.3);
    overflow: hidden;
    margin-bottom: 6px;
}

.storage-resource-fill {
    height: 100%;
    background: linear-gradient(90deg, var(--primary-color), rgba(0, 243, 255, 0.6));
    transition: width 0.3s ease;
}

.storage-resource-item.near-full .storage-resource-fill {
    background: linear-gradient(90deg, var(--warning-color), rgba(255, 174, 0, 0.6));
}

.storage-resource-item.full .storage-resource-fill {
    background: linear-gradient(90deg, var(--danger-color), rgba(255, 51, 102, 0.6));
}

.storage-resource-values {
    display: flex;
    justify-content: space-between;
    font-family: 'Orbitron', monospace;
    font-size: 0.8rem;
    color: var(--text-color);
}

.storage-resource-values span:first-child {
    font-weight: bold;
    color: var(--primary-color);
}

.storage-resource-item.full .storage-resource-values span:first-child {
    color: var(--danger-color);
}

/* 响应式调整 - 仓库 */
@media (max-width: 768px) {
    .storage-resources-grid {
        grid-template-columns: 1fr;
    }
}

/* ===== 资源选择模态框（矿机） ===== */
.resource-select-grid {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(160px, 1fr));
    gap: 12px;
    margin-top: 15px;
}

.resource-select-card {
    background: var(--panel-bg);
    border: 2px solid rgba(0, 243, 255, 0.3);
    padding: 12px;
    cursor: pointer;
    transition: all 0.3s ease;
    display: flex;
    flex-direction: column;
    gap: 8px;
}

.resource-select-card:hover {
    border-color: var(--primary-color);
    box-shadow: 0 0 15px rgba(0, 243, 255, 0.4);
    transform: translateY(-2px);
}

.resource-select-name {
    font-family: var(--font-header);
    font-size: 1rem;
    color: var(--primary-color);
    font-weight: bold;
    text-align: center;
}

.resource-select-info {
    display: flex;
    flex-direction: column;
    gap: 4px;
    font-size: 0.8rem;
    color: var(--text-color);
}

.resource-select-info div {
    padding: 3px 6px;
    background: rgba(0, 0, 0, 0.3);
    border-left: 2px solid var(--text-dim);
}

/* ===== 资源节点查看模态框 ===== */
.resource-nodes-modal {
    min-width: 500px;
    max-width: 700px;
}

.resource-nodes-grid {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(180px, 1fr));
    gap: 12px;
    max-height: 60vh;
    overflow-y: auto;
}

.resource-node-card {
    background: var(--panel-bg);
    border: 2px solid rgba(0, 243, 255, 0.3);
    padding: 12px;
    display: flex;
    flex-direction: column;
    gap: 8px;
}

.resource-node-card.resource-node-used {
    border-color: rgba(255, 174, 0, 0.4);
    background: rgba(255, 174, 0, 0.05);
}

.resource-node-name {
    font-family: var(--font-header);
    font-size: 0.9rem;
    color: var(--primary-color);
    font-weight: bold;
}

.resource-node-card.resource-node-used .resource-node-name {
    color: var(--secondary-color);
}

.resource-node-info {
    display: flex;
    flex-direction: column;
    gap: 4px;
    font-size: 0.8rem;
    color: var(--text-color);
}

.resource-node-info div {
    padding: 3px 6px;
    background: rgba(0, 0, 0, 0.3);
    border-left: 2px solid var(--text-dim);
}

/* 响应式调整 - 资源选择 */
@media (max-width: 768px) {
    .resource-select-grid {
        grid-template-columns: 1fr;
    }
}

/* ===== 地图界面 ===== */
.regions-grid {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
    gap: 15px;
    margin-top: 15px;
}

.regions-grid-compact {
    display: grid;
    grid-template-columns: repeat(4, 1fr);
    grid-template-rows: repeat(4, 1fr);
    gap: 10px;
    padding: 12px;
    height: calc(100vh - 200px);
}

.region-card {
    background: var(--panel-bg);
    border: 2px solid rgba(0, 243, 255, 0.3);
    padding: 12px;
    cursor: pointer;
    transition: all 0.3s ease;
    position: relative;
    overflow: hidden;
    display: flex;
    flex-direction: column;
    gap: 6px;
    height: 100%;
}

.region-card-name {
    font-weight: bold;
    font-size: 0.9rem;
    color: var(--primary-color);
}

.region-card-resources-compact {
    font-size: 0.75rem;
    color: var(--text-dim);
}

.region-card-enemies-compact {
    font-size: 0.75rem;
    color: #ff6b6b;
    font-weight: 600;
}

.region-card:hover {
    border-color: var(--primary-color);
    box-shadow: 0 0 20px rgba(0, 243, 255, 0.4);
    transform: translateY(-3px);
}

.region-card.conquered {
    border-color: rgba(0, 255, 100, 0.5);
    background: linear-gradient(135deg, var(--panel-bg) 0%, rgba(0, 255, 100, 0.05) 100%);
}

.region-card.locked {
    border-color: rgba(100, 100, 100, 0.3);
    background: rgba(0, 0, 0, 0.5);
    cursor: not-allowed;
    opacity: 0.6;
}

.region-card.locked:hover {
    transform: none;
    box-shadow: none;
}

.region-card.empty-slot {
    background: rgba(0, 0, 0, 0.2);
    border: 2px dashed rgba(100, 100, 100, 0.3);
    cursor: default;
    opacity: 0.4;
    display: flex;
    align-items: center;
    justify-content: center;
}

.region-card.empty-slot:hover {
    transform: none;
    box-shadow: none;
    border-color: rgba(100, 100, 100, 0.3);
}

.empty-slot-text {
    color: var(--text-dim);
    font-size: 0.8rem;
    text-align: center;
}

.region-card.boss {
    border-color: rgba(255, 50, 50, 0.6);
    background: linear-gradient(135deg, var(--panel-bg) 0%, rgba(255, 50, 50, 0.1) 100%);
}

.region-card.boss::before {
    content: "BOSS";
    position: absolute;
    top: 10px;
    right: 10px;
    background: rgba(255, 50, 50, 0.9);
    color: white;
    padding: 3px 10px;
    font-size: 0.7rem;
    font-weight: bold;
    border-radius: 3px;
    text-shadow: 0 0 5px rgba(255, 50, 50, 1);
}

.region-card-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 10px;
    padding-bottom: 8px;
    border-bottom: 1px solid rgba(0, 243, 255, 0.2);
}

.region-card-name {
    font-family: var(--font-header);
    font-size: 1.1rem;
    color: var(--primary-color);
    font-weight: bold;
}

.region-card.conquered .region-card-name {
    color: rgba(0, 255, 100, 1);
}

.region-card.boss .region-card-name {
    color: rgba(255, 100, 100, 1);
}

.region-card.locked .region-card-name {
    color: var(--text-dim);
}

.region-card-phase {
    font-size: 0.75rem;
    color: var(--text-dim);
    background: rgba(0, 0, 0, 0.3);
    padding: 3px 8px;
    border-radius: 3px;
}

.region-card-desc {
    font-size: 0.8rem;
    color: var(--text-color);
    margin-bottom: 10px;
    line-height: 1.4;
}

.region-card-info {
    display: flex;
    flex-direction: column;
    gap: 8px;
    margin-top: 10px;
}

.region-card-info-row {
    display: flex;
    justify-content: space-between;
    align-items: center;
    font-size: 0.8rem;
    padding: 5px 8px;
    background: rgba(0, 0, 0, 0.3);
    border-left: 2px solid rgba(0, 243, 255, 0.3);
}

.region-card-info-label {
    color: var(--text-dim);
}

.region-card-info-value {
    color: var(--text-color);
    font-weight: bold;
}

.region-card-resources {
    display: flex;
    flex-wrap: wrap;
    gap: 6px;
    margin-top: 8px;
}

.region-resource-tag {
    font-size: 0.7rem;
    padding: 3px 8px;
    background: rgba(0, 243, 255, 0.1);
    border: 1px solid rgba(0, 243, 255, 0.3);
    color: var(--primary-color);
    border-radius: 3px;
}

.region-card-enemies {
    display: flex;
    flex-direction: column;
    gap: 4px;
    margin-top: 8px;
}

.region-enemy-item {
    font-size: 0.75rem;
    padding: 4px 8px;
    background: rgba(255, 50, 50, 0.1);
    border-left: 2px solid rgba(255, 50, 50, 0.5);
    color: var(--text-color);
}

.region-card-status {
    margin-top: 12px;
    text-align: center;
    font-size: 0.85rem;
    padding: 8px;
    border-radius: 4px;
    font-weight: bold;
}

.region-card-status.status-conquered {
    background: rgba(0, 255, 100, 0.15);
    color: rgba(0, 255, 100, 1);
}

.region-card-status.status-available {
    background: rgba(255, 174, 0, 0.15);
    color: var(--secondary-color);
}

.region-card-status.status-locked {
    background: rgba(100, 100, 100, 0.15);
    color: var(--text-dim);
}

/* 响应式调整 - 地图 */
@media (max-width: 768px) {
    .regions-grid {
        grid-template-columns: 1fr;
    }
}

/* ===== 战斗界面 ===== */

/* 阵型网格 */
.formation-grid {
    display: flex;
    flex-direction: column;
    gap: 8px;
    margin-top: 10px;
}

.formation-slot {
    aspect-ratio: 1;
    background: rgba(0, 0, 0, 0.4);
    border: 2px solid rgba(0, 243, 255, 0.3);
    padding: 8px;
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    position: relative;
    cursor: pointer;
    transition: all 0.3s ease;
}

.formation-slot.empty:hover {
    border-color: var(--primary-color);
    background: rgba(0, 243, 255, 0.1);
}

.formation-slot.occupied {
    background: rgba(0, 243, 255, 0.15);
    border-color: var(--primary-color);
    cursor: default;
}

.enemy-formation .formation-slot.occupied {
    background: rgba(255, 50, 50, 0.15);
    border-color: rgba(255, 50, 50, 0.6);
}

.formation-slot-index {
    position: absolute;
    top: 3px;
    left: 6px;
    font-size: 0.7rem;
    color: var(--text-dim);
    font-weight: bold;
}

.formation-unit-name {
    font-size: 0.75rem;
    color: var(--primary-color);
    font-weight: bold;
    text-align: center;
    margin-bottom: 4px;
}

.enemy-formation .formation-unit-name {
    color: rgba(255, 100, 100, 1);
}

.formation-unit-hp {
    font-size: 0.7rem;
    color: var(--text-color);
    display: flex;
    align-items: center;
    gap: 4px;
}

.formation-unit-hp-bar {
    width: 100%;
    height: 4px;
    background: rgba(0, 0, 0, 0.5);
    border-radius: 2px;
    overflow: hidden;
    margin-top: 4px;
}

.formation-unit-hp-fill {
    height: 100%;
    background: linear-gradient(90deg, #00ff00, #00aa00);
    transition: width 0.3s ease;
}

.enemy-formation .formation-unit-hp-fill {
    background: linear-gradient(90deg, #ff3333, #aa0000);
}

.formation-unit-count {
    position: absolute;
    top: 3px;
    right: 6px;
    font-size: 0.7rem;
    color: var(--text-color);
    background: rgba(0, 0, 0, 0.6);
    padding: 2px 6px;
    border-radius: 3px;
}

.formation-slot.player-dragging {
    background: rgba(255, 174, 0, 0.2);
    border-color: var(--secondary-color);
}

/* 战斗中的阵型 */
.battle-active .formation-slot {
    cursor: default;
}

.battle-active .formation-slot.attacking {
    animation: attack-pulse 0.5s ease;
}

@keyframes attack-pulse {
    0%, 100% { transform: scale(1); }
    50% { transform: scale(1.1); box-shadow: 0 0 20px rgba(255, 174, 0, 0.8); }
}

.battle-active .formation-slot.damaged {
    animation: damage-shake 0.3s ease;
}

@keyframes damage-shake {
    0%, 100% { transform: translateX(0); }
    25% { transform: translateX(-4px); }
    75% { transform: translateX(4px); }
}

.battle-active .formation-slot.destroyed {
    opacity: 0.3;
    border-color: rgba(100, 100, 100, 0.3);
}

/* 可用单位列表 */
.available-units-list {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
    gap: 12px;
    margin-top: 10px;
}

.available-unit-card {
    background: var(--panel-bg);
    border: 2px solid rgba(0, 243, 255, 0.3);
    padding: 10px;
    cursor: pointer;
    transition: all 0.3s ease;
    display: flex;
    flex-direction: column;
    gap: 6px;
}

.available-unit-card:hover {
    border-color: var(--primary-color);
    box-shadow: 0 0 15px rgba(0, 243, 255, 0.4);
    transform: translateY(-2px);
}

.available-unit-card.selected {
    border-color: var(--secondary-color);
    background: rgba(255, 174, 0, 0.1);
}

.available-unit-card.unavailable {
    opacity: 0.5;
    cursor: not-allowed;
    border-color: rgba(100, 100, 100, 0.3);
}

.available-unit-card.unavailable:hover {
    transform: none;
    box-shadow: none;
}

.available-unit-name {
    font-family: var(--font-header);
    font-size: 0.85rem;
    color: var(--primary-color);
    font-weight: bold;
}

.available-unit-stats {
    display: flex;
    flex-direction: column;
    gap: 3px;
    font-size: 0.7rem;
    color: var(--text-color);
}

.available-unit-count {
    font-size: 0.75rem;
    color: var(--secondary-color);
    font-weight: bold;
}

/* 战斗准备操作 */
.battle-prep-actions {
    display: flex;
    gap: 15px;
    justify-content: center;
    margin-top: 10px;
}

.battle-prep-actions .btn {
    flex: 1;
    max-width: 200px;
    padding: 12px 20px;
    font-size: 1rem;
}

/* 战斗信息 */
.battle-info {
    padding: 10px;
    background: rgba(0, 0, 0, 0.3);
    border-left: 3px solid var(--primary-color);
    font-size: 0.85rem;
    color: var(--text-color);
    line-height: 1.6;
}

.battle-info div {
    margin-bottom: 5px;
}

.battle-actions {
    display: flex;
    gap: 15px;
    justify-content: center;
    margin-top: 10px;
}

.battle-actions .btn {
    min-width: 150px;
}

/* 单位选择器 */
.unit-selector-card {
    background: var(--panel-bg);
    border: 2px solid rgba(0, 243, 255, 0.3);
    padding: 12px;
    display: flex;
    flex-direction: column;
    gap: 8px;
}

.unit-selector-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
}

.unit-selector-name {
    font-family: var(--font-header);
    font-size: 0.9rem;
    color: var(--primary-color);
    font-weight: bold;
}

.unit-selector-available {
    font-size: 0.75rem;
    color: var(--text-dim);
}

.unit-selector-stats {
    display: flex;
    gap: 12px;
    font-size: 0.75rem;
    color: var(--text-color);
}

.unit-ammo-info {
    font-size: 0.7rem;
    color: var(--secondary-color);
}

.unit-selector-controls {
    display: flex;
    align-items: center;
    gap: 8px;
    justify-content: center;
}

.unit-selector-btn {
    background: rgba(0, 243, 255, 0.1);
    border: 1px solid var(--primary-color);
    color: var(--primary-color);
    padding: 4px 12px;
    border-radius: 3px;
    cursor: pointer;
    transition: all 0.3s ease;
    font-size: 0.85rem;
}

.unit-selector-btn:hover:not(:disabled) {
    background: rgba(0, 243, 255, 0.2);
}

.unit-selector-btn:disabled {
    opacity: 0.3;
    cursor: not-allowed;
}

.unit-selector-count {
    font-size: 1.1rem;
    color: var(--primary-color);
    font-weight: bold;
    min-width: 40px;
    text-align: center;
}

/* 敌方单位摘要 */
.enemy-unit-summary, .selected-unit-summary {
    background: rgba(0, 0, 0, 0.3);
    border-left: 3px solid rgba(255, 50, 50, 0.6);
    padding: 8px 12px;
    margin-bottom: 8px;
}

.selected-unit-summary {
    border-left-color: var(--primary-color);
}

.enemy-unit-name, .selected-unit-name {
    font-weight: bold;
    color: var(--text-color);
    font-size: 0.9rem;
    margin-bottom: 4px;
}

.enemy-unit-stats, .selected-unit-stats {
    font-size: 0.75rem;
    color: var(--text-dim);
}

/* 战斗血量对比 */
.battle-hp-comparison {
    display: flex;
    flex-direction: column;
    gap: 8px;
}

.battle-hp-bar-container {
    width: 100%;
}

.battle-hp-bar {
    width: 100%;
    height: 20px;
    background: rgba(255, 50, 50, 0.3);
    border-radius: 4px;
    overflow: hidden;
    position: relative;
}

.battle-hp-fill {
    height: 100%;
    transition: width 0.3s ease;
}

.battle-hp-fill.player {
    background: linear-gradient(90deg, #00ff64, #00aa44);
}

.battle-hp-stats {
    display: flex;
    justify-content: space-between;
    font-size: 0.9rem;
}

.battle-hp-label {
    color: var(--text-color);
}

/* 两列式编队 */
.battle-formations-container {
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: 15px;
}

.battle-formation-column h3 {
    font-size: 0.85rem;
    color: var(--primary-color);
    margin-bottom: 10px;
    text-align: center;
    font-family: var(--font-header);
}

.battle-formation-list {
    display: flex;
    flex-direction: column;
    gap: 6px;
}

/* 单位行 */
.battle-unit-row {
    display: flex;
    align-items: center;
    gap: 8px;
    font-size: 0.85rem;
    padding: 4px 8px;
    background: rgba(0, 0, 0, 0.2);
    border-left: 3px solid var(--primary-color);
}

.battle-unit-row.enemy {
    border-left-color: rgba(255, 50, 50, 0.8);
}

.battle-unit-row.no-ammo {
    opacity: 0.5;
    border-left-color: #888;
}

.battle-unit-row.no-ammo::after {
    content: "⚠️ 无弹药";
    margin-left: auto;
    color: var(--secondary-color);
    font-size: 0.7rem;
}

.battle-unit-name {
    flex: 0 0 100px;
    color: var(--text-color);
}

.battle-unit-hp-bar {
    flex: 1;
    height: 6px;
    background: rgba(0, 0, 0, 0.5);
    border-radius: 3px;
    overflow: hidden;
}

.battle-unit-hp-fill {
    height: 100%;
    background: linear-gradient(90deg, #00ff64, #00aa44);
    transition: width 0.3s ease;
}

.battle-unit-row.enemy .battle-unit-hp-fill {
    background: linear-gradient(90deg, #ff5555, #aa0000);
}

/* 战斗DPS信息 */
.battle-dps-info {
    display: flex;
    justify-content: space-around;
    font-size: 0.9rem;
    color: var(--text-color);
}

/* 弹药消耗列表 */
.battle-ammo-list {
    display: flex;
    flex-direction: column;
    gap: 8px;
}

.battle-ammo-item {
    display: flex;
    align-items: center;
    gap: 10px;
    font-size: 0.85rem;
}

.battle-ammo-name {
    flex: 0 0 80px;
    color: var(--text-color);
}

.battle-ammo-rate {
    flex: 0 0 60px;
    color: var(--text-dim);
}

.battle-ammo-bar {
    flex: 1;
    height: 8px;
    background: rgba(0, 0, 0, 0.5);
    border-radius: 4px;
    overflow: hidden;
}

.battle-ammo-fill {
    height: 100%;
    background: linear-gradient(90deg, var(--primary-color), rgba(0, 243, 255, 0.5));
    transition: width 0.3s ease;
}

.battle-ammo-fill.warning {
    background: linear-gradient(90deg, var(--secondary-color), rgba(255, 200, 0, 0.5));
}

.battle-ammo-fill.critical {
    background: linear-gradient(90deg, #ff5555, #aa0000);
}

.battle-ammo-count {
    flex: 0 0 100px;
    text-align: right;
    color: var(--text-color);
}

.battle-ammo-remaining {
    flex: 0 0 90px;
    text-align: right;
    color: var(--text-dim);
    font-size: 0.75rem;
}

/* 战斗时间和操作 */
.battle-time-actions {
    display: flex;
    justify-content: space-between;
    align-items: center;
}

.battle-time {
    font-size: 1rem;
    color: var(--text-color);
}

/* 军事界面 - 红色主题 */
[data-theme="military"] {
    --primary-color: #ff6b6b;
    --secondary-color: #ff8787;
}

.military-power-compact {
    display: flex;
    gap: 20px;
    padding: 10px 15px;
    background: rgba(255, 107, 107, 0.1);
    border-left: 3px solid #ff6b6b;
    margin-bottom: 15px;
    font-size: 0.95rem;
}

.military-power-compact .power-item {
    color: var(--text-color);
}

.military-power-compact .power-item span {
    color: #ff6b6b;
    font-weight: 700;
    font-size: 1.1rem;
}

/* 军事界面 - 部队和弹药列表 */
.military-units-grid {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(140px, 1fr));
    gap: 8px;
}

.military-unit-card {
    background: rgba(255, 107, 107, 0.1);
    border: 2px solid #ff6b6b;
    padding: 10px;
    display: flex;
    flex-direction: column;
    gap: 4px;
    transition: all 0.3s ease;
}

.military-unit-card:hover {
    background: rgba(255, 107, 107, 0.2);
    box-shadow: 0 0 15px rgba(255, 107, 107, 0.4);
    transform: translateY(-2px);
}

.military-unit-name {
    font-weight: bold;
    color: #ff6b6b;
    font-size: 0.85rem;
}

.military-unit-count {
    font-size: 1.1rem;
    color: var(--text-color);
}

.military-unit-stats {
    font-size: 0.7rem;
    color: var(--text-dim);
}

.military-ammo-grid {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(120px, 1fr));
    gap: 8px;
}

.military-ammo-card {
    background: rgba(0, 0, 0, 0.2);
    border: 2px solid rgba(255, 107, 107, 0.3);
    padding: 10px;
    display: flex;
    flex-direction: column;
    gap: 4px;
}

.military-ammo-name {
    font-weight: bold;
    color: var(--text-color);
    font-size: 0.8rem;
}

.military-ammo-count {
    font-size: 1rem;
    color: #ff6b6b;
}

/* 响应式调整 - 战斗 */
@media (max-width: 768px) {
    .formation-grid {
        grid-template-columns: repeat(3, 1fr);
    }

    .available-units-list {
        grid-template-columns: 1fr;
    }

    .battle-prep-actions, .battle-actions {
        flex-direction: column;
    }

    .battle-prep-actions .btn, .battle-actions .btn {
        max-width: 100%;
    }

    .military-units-grid, .military-ammo-grid {
        grid-template-columns: 1fr;
    }

    .battle-formations-container {
        grid-template-columns: 1fr;
    }
}

/* ===== 主菜单 ===== */
.main-menu {
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: linear-gradient(135deg, #050b14 0%, #0a1628 50%, #050b14 100%);
    display: flex;
    align-items: center;
    justify-content: center;
    z-index: 10000;
    animation: fadeIn 0.5s ease-out;
    overflow-y: auto;
}

.main-menu[style*="display: none"],
.main-menu[style*="display:none"] {
    pointer-events: none;
}

.main-menu-content {
    text-align: center;
    max-width: 600px;
    padding: 40px;
    margin: 0 auto;
}

.main-menu-title {
    font-family: var(--font-header);
    font-size: 4rem;
    color: var(--primary-color);
    text-shadow: 0 0 20px rgba(0, 243, 255, 0.8),
                 0 0 40px rgba(0, 243, 255, 0.4);
    margin: 0 0 10px 0;
    letter-spacing: 4px;
    animation: glow 2s ease-in-out infinite;
}

.main-menu-subtitle {
    font-family: var(--font-header);
    font-size: 1.5rem;
    color: var(--secondary-color);
    margin: 0 0 60px 0;
    letter-spacing: 8px;
    opacity: 0.8;
}

.main-menu-buttons {
    display: flex;
    flex-direction: column;
    gap: 20px;
    margin-bottom: 40px;
}

.menu-btn {
    background: rgba(0, 243, 255, 0.1);
    border: 2px solid var(--primary-color);
    color: var(--text-color);
    padding: 20px 40px;
    font-size: 1.3rem;
    font-family: var(--font-body);
    cursor: pointer;
    transition: all 0.3s ease;
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 15px;
    border-radius: 4px;
}

.menu-btn:hover {
    background: rgba(0, 243, 255, 0.2);
    box-shadow: 0 0 20px rgba(0, 243, 255, 0.5);
    transform: translateX(5px);
}

.menu-btn-primary {
    border-color: var(--primary-color);
}

.menu-btn-secondary {
    border-color: var(--secondary-color);
}

.menu-btn-tertiary {
    border-color: var(--text-dim);
}

.menu-btn-danger {
    border-color: var(--danger-color);
}

.menu-btn-danger:hover {
    background: rgba(255, 51, 102, 0.2);
    border-color: var(--danger-color);
    box-shadow: 0 0 20px rgba(255, 51, 102, 0.4);
}

.menu-btn-icon {
    font-size: 1.5rem;
}

.menu-btn-text {
    font-weight: 700;
    letter-spacing: 2px;
}

.main-menu-footer {
    color: var(--text-dim);
    font-size: 0.9rem;
}

.main-menu-footer p {
    margin: 5px 0;
}

@keyframes glow {
    0%, 100% {
        text-shadow: 0 0 20px rgba(0, 243, 255, 0.8),
                     0 0 40px rgba(0, 243, 255, 0.4);
    }
    50% {
        text-shadow: 0 0 30px rgba(0, 243, 255, 1),
                     0 0 60px rgba(0, 243, 255, 0.6);
    }
}

@keyframes fadeIn {
    from {
        opacity: 0;
    }
    to {
        opacity: 1;
    }
}

/* ===== 存档槽位 ===== */
.save-slots-container {
    display: flex;
    flex-direction: column;
    gap: 15px;
    margin-bottom: 30px;
}

.save-slot {
    background: rgba(0, 243, 255, 0.05);
    border: 2px solid rgba(0, 243, 255, 0.3);
    padding: 20px;
    cursor: pointer;
    transition: all 0.3s ease;
    text-align: left;
    border-radius: 4px;
}

.save-slot:hover {
    background: rgba(0, 243, 255, 0.1);
    border-color: var(--primary-color);
    box-shadow: 0 0 15px rgba(0, 243, 255, 0.3);
}

.save-slot-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 10px;
}

.save-slot-title {
    font-size: 1.2rem;
    font-weight: bold;
    color: var(--primary-color);
}

.save-slot-name {
    font-size: 1.2rem;
    font-weight: bold;
    color: var(--primary-color);
}

.save-slot-date {
    font-size: 0.9rem;
    color: var(--text-dim);
}

.save-slot-info {
    display: grid;
    grid-template-columns: repeat(2, 1fr);
    gap: 8px;
    font-size: 0.9rem;
    color: var(--text-color);
    margin-bottom: 10px;
}

.save-slot-info div {
    padding: 4px 8px;
    background: rgba(0, 0, 0, 0.3);
    border-left: 2px solid rgba(0, 243, 255, 0.3);
}

.save-slot-empty {
    text-align: center;
    color: var(--text-dim);
    font-style: italic;
    padding: 40px 20px;
    border-style: dashed;
}

.save-slot-empty:hover {
    background: transparent;
    border-color: rgba(0, 243, 255, 0.3);
    box-shadow: none;
}

.save-slot-actions {
    margin-top: 15px;
    display: flex;
    gap: 10px;
}

.save-slot-btn {
    background: rgba(0, 243, 255, 0.1);
    border: 1px solid var(--primary-color);
    color: var(--text-color);
    padding: 8px 16px;
    font-size: 0.9rem;
    cursor: pointer;
    transition: all 0.2s ease;
    border-radius: 4px;
    font-family: var(--font-body);
}

.save-slot-btn:hover {
    background: rgba(0, 243, 255, 0.2);
}

.save-slot-btn.danger {
    border-color: var(--danger-color);
    color: var(--danger-color);
}

.save-slot-btn.danger:hover {
    background: rgba(255, 51, 102, 0.2);
}
/* ===== 新UI布局 - 紧凑单页设计 ===== */

/* 全局工具栏 - 第一行 */
.global-toolbar {
    display: flex;
    align-items: center;
    gap: 12px;
    padding: 8px 12px;
    background: rgba(16, 33, 49, 0.95);
    border-bottom: 1px solid var(--primary-color);
    box-shadow: var(--border-glow);
    flex-wrap: wrap;
}

.toolbar-item {
    font-family: var(--font-body);
    font-size: 14px;
    color: var(--text-color);
    padding: 4px 8px;
    background: rgba(0, 0, 0, 0.3);
    border-radius: 4px;
}

.toolbar-btn {
    padding: 4px 12px;
    background: rgba(0, 243, 255, 0.1);
    border: 1px solid var(--primary-color);
    color: var(--primary-color);
    cursor: pointer;
    font-family: var(--font-body);
    font-size: 13px;
    border-radius: 4px;
    transition: all 0.2s;
}

.toolbar-btn:hover {
    background: rgba(0, 243, 255, 0.2);
    box-shadow: 0 0 8px rgba(0, 243, 255, 0.5);
}

.toolbar-region-name {
    font-family: var(--font-header);
    font-size: 16px;
    color: var(--primary-color);
    font-weight: 700;
    text-shadow: 0 0 8px var(--primary-color);
}

/* 生产统计内联显示 */
.production-stats-inline {
    padding: 8px 12px;
    background: rgba(0, 0, 0, 0.5);
    border-radius: 4px;
    max-height: 120px;
    overflow-y: auto;
    font-size: 12px;
}

/* 资源栏 - 第二行 */
.resources-bar {
    display: flex;
    align-items: center;
    gap: 8px;
    padding: 8px 12px;
    background: rgba(10, 20, 30, 0.9);
    border-bottom: 1px solid rgba(0, 243, 255, 0.3);
    overflow: hidden;
}

.resources-scroll {
    display: flex;
    gap: 6px;
    overflow-x: auto;
    flex: 1;
    padding: 2px 0;
}

.resources-scroll::-webkit-scrollbar {
    height: 4px;
}

.resources-scroll::-webkit-scrollbar-thumb {
    background: var(--primary-color);
    border-radius: 2px;
}

.resource-chip {
    display: flex;
    align-items: center;
    gap: 6px;
    padding: 4px 10px;
    background: rgba(0, 243, 255, 0.08);
    border: 1px solid rgba(0, 243, 255, 0.3);
    border-radius: 12px;
    white-space: nowrap;
    font-size: 12px;
    transition: all 0.2s;
}

.resource-chip:hover {
    background: rgba(0, 243, 255, 0.15);
    border-color: var(--primary-color);
}

.resource-chip .res-name {
    color: var(--text-dim);
    font-size: 11px;
}

.resource-chip .res-val {
    color: var(--primary-color);
    font-weight: 700;
    font-family: var(--font-header);
}

.resources-bar-btn {
    padding: 6px 16px;
    background: rgba(0, 255, 136, 0.1);
    border: 1px solid var(--success-color);
    color: var(--success-color);
    cursor: pointer;
    font-family: var(--font-body);
    font-size: 13px;
    border-radius: 4px;
    white-space: nowrap;
    transition: all 0.2s;
}

.resources-bar-btn:hover {
    background: rgba(0, 255, 136, 0.2);
    box-shadow: 0 0 8px rgba(0, 255, 136, 0.5);
}

/* 4x4建筑网格 */
.buildings-grid-4x4 {
    display: grid;
    grid-template-columns: repeat(4, 1fr);
    grid-template-rows: repeat(4, 1fr);
    gap: 8px;
    padding: 12px;
    height: calc(100vh - 240px); /* 调整高度以适应顶部工具栏和资源栏 */
    background: rgba(5, 11, 20, 0.5);
    position: relative; /* For absolute positioning of bullets */
}

/* 4x4网格中的建筑卡片 */
.buildings-grid-4x4 .building-card-compact {
    height: 100%;
    display: flex;
    flex-direction: column;
    justify-content: space-between;
}

/* 建筑槽位 */
.building-slot {
    position: relative;
    background: rgba(16, 33, 49, 0.6);
    border: 1px solid rgba(0, 243, 255, 0.2);
    border-radius: 8px;
    overflow: hidden;
    transition: all 0.3s;
    cursor: pointer;
    display: flex;
    flex-direction: column;
}

.building-slot:hover {
    border-color: var(--primary-color);
    box-shadow: var(--border-glow);
    transform: translateY(-2px);
}

/* 空槽位 */
.building-slot.empty {
    display: flex;
    align-items: center;
    justify-content: center;
    background: rgba(16, 33, 49, 0.3);
    border-style: dashed;
    position: relative;
}

.building-slot.empty:hover {
    background: rgba(0, 243, 255, 0.05);
}

.empty-slot-icon {
    font-size: 48px;
    color: rgba(0, 243, 255, 0.3);
    transition: all 0.3s;
}

.building-slot.empty:hover .empty-slot-icon {
    color: var(--primary-color);
    transform: scale(1.2);
}

/* 槽位属性显示 */
.slot-property {
    position: absolute;
    top: 8px;
    left: 8px;
    right: 8px;
    text-align: center;
    pointer-events: none;
}

.slot-resource-name {
    font-size: 12px;
    font-weight: 700;
    color: var(--success-color);
    margin-bottom: 4px;
    font-family: var(--font-header);
}

.slot-resource-amount {
    font-size: 10px;
    color: var(--text-dim);
    font-family: var(--font-body);
}

/* 槽位+按钮 */
.slot-add-btn {
    position: absolute;
    bottom: 8px;
    right: 8px;
    width: 32px;
    height: 32px;
    border-radius: 50%;
    background: rgba(0, 243, 255, 0.2);
    border: 2px solid rgba(0, 243, 255, 0.4);
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 24px;
    color: var(--primary-color);
    transition: all 0.3s;
}

.building-slot.empty:hover .slot-add-btn {
    background: rgba(0, 243, 255, 0.3);
    border-color: var(--primary-color);
    transform: scale(1.1);
}

/* 建筑槽位内容 */
.slot-building-name {
    padding: 6px 8px;
    background: rgba(0, 0, 0, 0.6);
    font-size: 11px;
    font-weight: 700;
    color: var(--primary-color);
    border-bottom: 1px solid rgba(0, 243, 255, 0.3);
    text-align: center;
    font-family: var(--font-header);
}

.slot-building-info {
    flex: 1;
    padding: 8px;
    display: flex;
    flex-direction: column;
    gap: 4px;
    font-size: 10px;
    color: var(--text-dim);
}

.slot-recipe-name {
    color: var(--text-color);
    font-size: 11px;
    margin-bottom: 2px;
}

.slot-progress-bar {
    width: 100%;
    height: 4px;
    background: rgba(0, 0, 0, 0.5);
    border-radius: 2px;
    overflow: hidden;
    margin-top: auto;
}

.slot-progress-fill {
    height: 100%;
    background: linear-gradient(90deg, var(--primary-color), var(--success-color));
    transition: width 0.2s;
}

.slot-status {
    display: flex;
    gap: 4px;
    font-size: 10px;
    margin-top: 4px;
}

.slot-status-icon {
    width: 16px;
    height: 16px;
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 10px;
}

.slot-status-icon.active {
    background: rgba(0, 255, 136, 0.2);
    border: 1px solid var(--success-color);
    color: var(--success-color);
}

.slot-status-icon.paused {
    background: rgba(255, 174, 0, 0.2);
    border: 1px solid var(--warning-color);
    color: var(--warning-color);
}

/* ===== 固定宽度防抖动 ===== */
.toolbar-item.time-display {
    min-width: 75px; /* 显示 "⏰ 12pm" */
}

.toolbar-item.power-display {
    min-width: 85px; /* 显示 "⚡ 100%" */
}

.toolbar-region-name {
    min-width: 80px;
    text-align: center;
}

/* ===== 两行资源显示 ===== */
.resources-bar-v2 {
    display: flex;
    align-items: center;
    gap: 8px;
    padding: 8px 12px;
    background: rgba(10, 20, 30, 0.9);
    border-bottom: 1px solid rgba(0, 243, 255, 0.3);
}

.resources-grid-v2 {
    display: flex;
    gap: 6px;
    overflow-x: auto;
    flex: 1;
    padding: 4px 0;
}

.resources-grid-v2::-webkit-scrollbar {
    height: 4px;
}

.resources-grid-v2::-webkit-scrollbar-thumb {
    background: var(--primary-color);
    border-radius: 2px;
}

.resource-item-v2 {
    display: flex;
    flex-direction: column;
    align-items: center;
    padding: 6px 10px;
    background: rgba(0, 243, 255, 0.08);
    border: 1px solid rgba(0, 243, 255, 0.3);
    border-radius: 6px;
    min-width: 70px;
    transition: all 0.2s;
}

.resource-item-v2:hover {
    background: rgba(0, 243, 255, 0.15);
    border-color: var(--primary-color);
}

.resource-item-v2 .res-label {
    color: var(--text-dim);
    font-size: 11px;
    margin-bottom: 2px;
    white-space: nowrap;
}

.resource-item-v2 .res-value {
    color: var(--primary-color);
    font-weight: 700;
    font-family: var(--font-header);
    font-size: 14px;
}

/* ======================================== */
/* Battle Grid Styles */
/* ======================================== */

.battle-grid-cell {
    background: rgba(0, 0, 0, 0.3);
    border: 1px solid rgba(0, 243, 255, 0.2);
    display: flex;
    align-items: center;
    justify-content: center;
    padding: 6px;
    position: relative;
    min-height: 80px;
}

.battle-grid-cell.enemy-cell {
    border-color: rgba(255, 51, 102, 0.4);
    background: rgba(255, 51, 102, 0.05);
}

.battle-grid-cell.player-cell {
    border-color: rgba(0, 255, 136, 0.4);
    background: rgba(0, 255, 136, 0.05);
}

.troop-info {
    width: 100%;
    font-size: 10px;
}

.troop-name {
    font-weight: bold;
    color: var(--primary-color);
    margin-bottom: 2px;
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
}

.troop-count {
    color: var(--text-dim);
    font-family: monospace;
    font-size: 11px;
}

.troop-hp-bar, .troop-cooldown-bar {
    height: 4px;
    background: rgba(0, 0, 0, 0.5);
    margin: 3px 0;
    border-radius: 2px;
    overflow: hidden;
}

.troop-hp-fill {
    height: 100%;
    background: linear-gradient(90deg, #00ff88, #00ffcc);
    transition: width 0.3s;
}

.enemy-cell .troop-hp-fill {
    background: linear-gradient(90deg, #ff3366, #ff6699);
}

.troop-cooldown-fill {
    height: 100%;
    background: rgba(0, 243, 255, 0.8);
    transition: width 0.033s linear; /* Smooth animation matching update rate */
}

.troop-stats {
    font-size: 9px;
    color: var(--text-dim);
}

.troop-status {
    font-size: 9px;
    font-weight: bold;
    text-transform: uppercase;
    margin: 2px 0;
    padding: 1px 3px;
    border-radius: 2px;
}

.troop-status-preparing {
    color: #ffdd00;
    background: rgba(255, 221, 0, 0.1);
}

.troop-status-attacking {
    color: #ff3366;
    background: rgba(255, 51, 102, 0.1);
}

.troop-status-no_ammo {
    color: #ff9500;
    background: rgba(255, 149, 0, 0.1);
}

.troop-status-idle {
    color: #888;
    background: rgba(136, 136, 136, 0.1);
}

.troop-status-recovering {
    color: #00ff88;
    background: rgba(0, 255, 136, 0.1);
}

.troop-ammo {
    font-size: 9px;
    color: #00ffcc;
    font-weight: bold;
    margin: 2px 0;
}

.empty-cell-label {
    color: rgba(255, 255, 255, 0.1);
    font-size: 9px;
}

/* Battle Status Container */
.battle-status-container {
    margin: 10px 0;
    padding: 10px;
    background: rgba(0, 0, 0, 0.3);
    border: 1px solid rgba(0, 243, 255, 0.2);
    border-radius: 4px;
}

.battle-header-bars {
    display: flex;
    flex-direction: column;
    gap: 6px;
}

.battle-status-bar {
    display: flex;
    height: 12px;
    background: rgba(0, 0, 0, 0.5);
    border-radius: 6px;
    overflow: hidden;
}

.bar-section {
    height: 100%;
    transition: width 0.3s;
}

.enemy-bar {
    background: linear-gradient(90deg, #ff3366, #ff6699);
}

.player-bar {
    background: linear-gradient(90deg, #00ff88, #00ffcc);
}

.battle-status-text {
    display: flex;
    justify-content: space-between;
    font-size: 11px;
}

.enemy-hp {
    color: #ff6699;
}

.player-hp {
    color: #00ffcc;
}

/* Deployment Buttons */
.deployment-buttons-container {
    margin: 10px 0;
    padding: 10px;
    background: rgba(0, 0, 0, 0.3);
    border: 1px solid rgba(0, 243, 255, 0.2);
    border-radius: 4px;
}

.deployment-buttons-container h3 {
    margin: 0 0 8px 0;
    font-size: 0.9rem;
    color: var(--primary-color);
}

.deployment-buttons {
    display: flex;
    gap: 6px;
    flex-wrap: wrap;
}

.deploy-drone-btn {
    background: rgba(0, 243, 255, 0.1);
    border: 1px solid var(--primary-color);
    color: var(--primary-color);
    padding: 6px 12px;
    font-size: 11px;
    cursor: pointer;
    border-radius: 3px;
    transition: all 0.2s;
}

.deploy-drone-btn:hover {
    background: rgba(0, 243, 255, 0.2);
    transform: translateY(-1px);
}

/* Battle Effects */
.battle-bullet {
    position: absolute;
    width: 6px;
    height: 6px;
    border-radius: 50%;
    /* Background color is set dynamically in JavaScript based on attacker side */
    box-shadow: 0 0 4px rgba(0, 0, 0, 0.3);
    pointer-events: none;
    z-index: 1000;
}

.battle-damage-number {
    position: absolute;
    top: 10px;
    left: 50%;
    transform: translateX(-50%);
    color: #ffeb3b;
    font-weight: bold;
    font-size: 12px; /* Smaller for less obstruction */
    pointer-events: none;
    animation: floatUp 1s ease-out forwards; /* Faster: 1s */
    text-shadow: 0 0 3px rgba(255, 235, 59, 0.8);
    z-index: 999;
}

@keyframes floatUp {
    from {
        opacity: 1;
        transform: translateX(-50%) translateY(0) scale(1);
    }
    50% {
        opacity: 1;
        transform: translateX(-50%) translateY(-15px) scale(1);
    }
    to {
        opacity: 0;
        transform: translateX(-50%) translateY(-30px) scale(0.9);
    }
}

